!function(a){var b="process"in a,c=function(){function a(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}function b(a,b,c,d,e,f){this.message=a,this.expected=b,this.found=c,this.offset=d,this.line=e,this.column=f,this.name="SyntaxError"}function c(a){function c(){return a.substring(gc,fc)}function d(b){function c(b,c,d){var e,f;for(e=c;d>e;e++)f=a.charAt(e),"\n"===f?(b.seenCR||b.line++,b.column=1,b.seenCR=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(b.line++,b.column=1,b.seenCR=!0):(b.column++,b.seenCR=!1)}return hc!==b&&(hc>b&&(hc=0,ic={line:1,column:1,seenCR:!1}),c(ic,hc,b),hc=b),ic}function e(a){jc>fc||(fc>jc&&(jc=fc,kc=[]),kc.push(a))}function f(c,e,f){function g(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d,e,f,g=Array(a.length);for(f=0;f<a.length;f++)g[f]=a[f].description;return d=a.length>1?g.slice(0,-1).join(", ")+" or "+g[a.length-1]:g[0],e=b?'"'+c(b)+'"':"end of input","Expected "+d+" but "+e+" found."}var i=d(f),j=f<a.length?a.charAt(f):null;return null!==e&&g(e),new b(null!==c?c:h(e,j),e,j,f,i.line,i.column)}function g(){var a;return a=h()}function h(){var a,b;for(a=[],b=j(),b===K&&(b=i());b!==K;)a.push(b),b=j(),b===K&&(b=i());return a}function i(){var b,c,d,f,g,h,i;if(b=fc,c=fc,d=[],f=[],O.test(a.charAt(fc))?(g=a.charAt(fc),fc++):(g=K,0===lc&&e(P)),g!==K)for(;g!==K;)f.push(g),O.test(a.charAt(fc))?(g=a.charAt(fc),fc++):(g=K,0===lc&&e(P));else f=N;if(f===K&&(f=fc,g=fc,lc++,h=fc,lc++,i=j(),lc--,i===K?h=Q:(fc=h,h=N),lc--,h!==K?(fc=g,g=Q):g=N,g!==K?(91===a.charCodeAt(fc)?(h=R,fc++):(h=K,0===lc&&e(S)),h!==K?(g=[g,h],f=g):(fc=f,f=N)):(fc=f,f=N)),f!==K)for(;f!==K;){if(d.push(f),f=[],O.test(a.charAt(fc))?(g=a.charAt(fc),fc++):(g=K,0===lc&&e(P)),g!==K)for(;g!==K;)f.push(g),O.test(a.charAt(fc))?(g=a.charAt(fc),fc++):(g=K,0===lc&&e(P));else f=N;f===K&&(f=fc,g=fc,lc++,h=fc,lc++,i=j(),lc--,i===K?h=Q:(fc=h,h=N),lc--,h!==K?(fc=g,g=Q):g=N,g!==K?(91===a.charCodeAt(fc)?(h=R,fc++):(h=K,0===lc&&e(S)),h!==K?(g=[g,h],f=g):(fc=f,f=N)):(fc=f,f=N))}else d=N;return d!==K&&(d=a.substring(c,fc)),c=d,c!==K&&(gc=b,c=T(c)),b=c}function j(){var a;return a=k(),a===K&&(a=l(),a===K&&(a=m(),a===K&&(a=n(),a===K&&(a=o())))),a}function k(){var b,c,d;return b=fc,a.substr(fc,9)===U?(c=U,fc+=9):(c=K,0===lc&&e(V)),c!==K?(d=w(),d===K&&(d=A()),d===K&&(d=W),d!==K?(gc=b,c=X(),b=c):(fc=b,b=N)):(fc=b,b=N),b}function l(){var b,c,d,f,g;return b=fc,a.substr(fc,9)===Y?(c=Y,fc+=9):(c=K,0===lc&&e(Z)),c!==K?(d=p(),d!==K?(93===a.charCodeAt(fc)?(f=$,fc++):(f=K,0===lc&&e(_)),f!==K?(g=w(),g===K&&(g=A()),g===K&&(g=W),g!==K?(gc=b,c=ab(d),b=c):(fc=b,b=N)):(fc=b,b=N)):(fc=b,b=N)):(fc=b,b=N),b}function m(){var b,c,d,f,g,h;return b=fc,a.substr(fc,12)===bb?(c=bb,fc+=12):(c=K,0===lc&&e(cb)),c!==K?(d=r(),d!==K?(f=fc,45===a.charCodeAt(fc)?(g=db,fc++):(g=K,0===lc&&e(eb)),g!==K?(h=s(),h!==K?(g=[g,h],f=g):(fc=f,f=N)):(fc=f,f=N),f===K&&(f=W),f!==K?(93===a.charCodeAt(fc)?(g=$,fc++):(g=K,0===lc&&e(_)),g!==K?(gc=b,c=fb(d,f),b=c):(fc=b,b=N)):(fc=b,b=N)):(fc=b,b=N)):(fc=b,b=N),b}function n(){var b,c,d,f;return b=fc,a.substr(fc,6)===gb?(c=gb,fc+=6):(c=K,0===lc&&e(hb)),c!==K?(d=s(),d!==K?(93===a.charCodeAt(fc)?(f=$,fc++):(f=K,0===lc&&e(_)),f!==K?(gc=b,c=ib(d),b=c):(fc=b,b=N)):(fc=b,b=N)):(fc=b,b=N),b}function o(){var b,c,d,f,g,h,i,j;if(b=fc,a.substr(fc,10)===jb?(c=jb,fc+=10):(c=K,0===lc&&e(kb)),c!==K)if(d=q(),d!==K)if(62===a.charCodeAt(fc)?(f=lb,fc++):(f=K,0===lc&&e(mb)),f!==K){for(g=[],h=C();h!==K;)g.push(h),h=C();if(g!==K)if(h=t(),h!==K){for(i=[],j=C();j!==K;)i.push(j),j=C();i!==K?(a.substr(fc,2)===nb?(j=nb,fc+=2):(j=K,0===lc&&e(ob)),j!==K?(gc=b,c=pb(d,h),b=c):(fc=b,b=N)):(fc=b,b=N)}else fc=b,b=N;else fc=b,b=N}else fc=b,b=N;else fc=b,b=N;else fc=b,b=N;return b}function p(){var b,c,d,f;for(b=fc,c=fc,d=[],qb.test(a.charAt(fc))?(f=a.charAt(fc),fc++):(f=K,0===lc&&e(rb));f!==K;)d.push(f),qb.test(a.charAt(fc))?(f=a.charAt(fc),fc++):(f=K,0===lc&&e(rb));return d!==K&&(d=a.substring(c,fc)),c=d,c!==K&&(gc=b,c=sb(c)),b=c}function q(){var b,c,d,f;for(b=fc,c=fc,d=[],tb.test(a.charAt(fc))?(f=a.charAt(fc),fc++):(f=K,0===lc&&e(ub));f!==K;)d.push(f),tb.test(a.charAt(fc))?(f=a.charAt(fc),fc++):(f=K,0===lc&&e(ub));return d!==K&&(d=a.substring(c,fc)),c=d,c!==K&&(gc=b,c=sb(c)),b=c}function r(){var b,c,d;if(b=fc,c=[],d=x(),d!==K)for(;d!==K;)c.push(d),d=x();else c=N;return c!==K&&(c=a.substring(b,fc)),b=c}function s(){var b,c,d,e;if(b=fc,c=fc,d=[],e=x(),e!==K)for(;e!==K;)d.push(e),e=x();else d=N;return d!==K&&(d=a.substring(c,fc)),c=d,c!==K&&(gc=b,c=vb(c)),b=c}function t(){var b,c,d,f,g,h,i;if(b=fc,c=fc,d=fc,f=fc,a.substr(fc,4)===wb?(g=wb,fc+=4):(g=K,0===lc&&e(xb)),g!==K?(115===a.charCodeAt(fc)?(h=yb,fc++):(h=K,0===lc&&e(zb)),h===K&&(h=W),h!==K?(g=[g,h],f=g):(fc=f,f=N)):(fc=f,f=N),f===K&&(f=W),f!==K)if(a.substr(fc,3)===Ab?(g=Ab,fc+=3):(g=K,0===lc&&e(Bb)),g!==K){for(h=[],i=u();i!==K;)h.push(i),i=u();h!==K?(f=[f,g,h],d=f):(fc=d,d=N)}else fc=d,d=N;else fc=d,d=N;return d!==K&&(d=a.substring(c,fc)),c=d,c!==K&&(gc=b,c=Cb(c)),b=c}function u(){var b,c,d,f;if(b=v(),b===K&&(b=x(),b===K)){if(b=fc,37===a.charCodeAt(fc)?(c=Db,fc++):(c=K,0===lc&&e(Eb)),c!==K){if(d=[],f=y(),f!==K)for(;f!==K;)d.push(f),f=y();else d=N;d!==K?(c=[c,d],b=c):(fc=b,b=N)}else fc=b,b=N;b===K&&(Fb.test(a.charAt(fc))?(b=a.charAt(fc),fc++):(b=K,0===lc&&e(Gb)))}return b}function v(){var b;return Hb.test(a.charAt(fc))?(b=a.charAt(fc),fc++):(b=K,0===lc&&e(Ib)),b===K&&(Jb.test(a.charAt(fc))?(b=a.charAt(fc),fc++):(b=K,0===lc&&e(Kb))),b}function w(){var b;return 13===a.charCodeAt(fc)?(b=Lb,fc++):(b=K,0===lc&&e(Mb)),b}function x(){var b;return Nb.test(a.charAt(fc))?(b=a.charAt(fc),fc++):(b=K,0===lc&&e(Ob)),b}function y(){var b;return b=x(),b===K&&(65===a.charCodeAt(fc)?(b=Pb,fc++):(b=K,0===lc&&e(Qb)),b===K&&(66===a.charCodeAt(fc)?(b=Rb,fc++):(b=K,0===lc&&e(Sb)),b===K&&(67===a.charCodeAt(fc)?(b=Tb,fc++):(b=K,0===lc&&e(Ub)),b===K&&(68===a.charCodeAt(fc)?(b=Vb,fc++):(b=K,0===lc&&e(Wb)),b===K&&(69===a.charCodeAt(fc)?(b=Xb,fc++):(b=K,0===lc&&e(Yb)),b===K&&(70===a.charCodeAt(fc)?(b=Zb,fc++):(b=K,0===lc&&e($b)))))))),b}function z(){var b;return 9===a.charCodeAt(fc)?(b=_b,fc++):(b=K,0===lc&&e(ac)),b}function A(){var b;return 10===a.charCodeAt(fc)?(b=bc,fc++):(b=K,0===lc&&e(cc)),b}function B(){var b;return 32===a.charCodeAt(fc)?(b=dc,fc++):(b=K,0===lc&&e(ec)),b}function C(){var a;return a=B(),a===K&&(a=z()),a}function c(a){return{type:"text",val:a}}function D(){return{type:"tag",name:"newpage"}}function E(a){return{type:"tag",name:"chapter",title:a}}function F(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function G(a){return{type:"tag",name:"jump",pageNumber:a}}function H(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}var I,J=arguments.length>1?arguments[1]:{},K={},L={start:g},M=g,N=K,O=/^[^[]/,P={type:"class",value:"[^[]",description:"[^[]"},Q=void 0,R="[",S={type:"literal",value:"[",description:'"["'},T=function(a){return c(a)},U="[newpage]",V={type:"literal",value:"[newpage]",description:'"[newpage]"'},W=null,X=function(){return D()},Y="[chapter:",Z={type:"literal",value:"[chapter:",description:'"[chapter:"'},$="]",_={type:"literal",value:"]",description:'"]"'},ab=function(a){return E(a)},bb="[pixivimage:",cb={type:"literal",value:"[pixivimage:",description:'"[pixivimage:"'},db="-",eb={type:"literal",value:"-",description:'"-"'},fb=function(a,b){return F(a,b&&b[1])},gb="[jump:",hb={type:"literal",value:"[jump:",description:'"[jump:"'},ib=function(a){return G(a)},jb="[[jumpuri:",kb={type:"literal",value:"[[jumpuri:",description:'"[[jumpuri:"'},lb=">",mb={type:"literal",value:">",description:'">"'},nb="]]",ob={type:"literal",value:"]]",description:'"]]"'},pb=function(a,b){return H(a,b)},qb=/^[^\]]/,rb={type:"class",value:"[^\\]]",description:"[^\\]]"},sb=function(a){return a.trim()},tb=/^[^>]/,ub={type:"class",value:"[^>]",description:"[^>]"},vb=function(a){return parseInt(a,10)},wb="http",xb={type:"literal",value:"http",description:'"http"'},yb="s",zb={type:"literal",value:"s",description:'"s"'},Ab="://",Bb={type:"literal",value:"://",description:'"://"'},Cb=function(a){return a},Db="%",Eb={type:"literal",value:"%",description:'"%"'},Fb=/^[\-._~!$&'()*+,;=:\/@.?#]/,Gb={type:"class",value:"[\\-._~!$&'()*+,;=:\\/@.?#]",description:"[\\-._~!$&'()*+,;=:\\/@.?#]"},Hb=/^[A-Z]/,Ib={type:"class",value:"[A-Z]",description:"[A-Z]"},Jb=/^[a-z]/,Kb={type:"class",value:"[a-z]",description:"[a-z]"},Lb="\r",Mb={type:"literal",value:"\r",description:'"\\r"'},Nb=/^[0-9]/,Ob={type:"class",value:"[0-9]",description:"[0-9]"},Pb="A",Qb={type:"literal",value:"A",description:'"A"'},Rb="B",Sb={type:"literal",value:"B",description:'"B"'},Tb="C",Ub={type:"literal",value:"C",description:'"C"'},Vb="D",Wb={type:"literal",value:"D",description:'"D"'},Xb="E",Yb={type:"literal",value:"E",description:'"E"'},Zb="F",$b={type:"literal",value:"F",description:'"F"'},_b="	",ac={type:"literal",value:"	",description:'"\\t"'},bc="\n",cc={type:"literal",value:"\n",description:'"\\n"'},dc=" ",ec={type:"literal",value:" ",description:'" "'},fc=0,gc=0,hc=0,ic={line:1,column:1,seenCR:!1},jc=0,kc=[],lc=0;if("startRule"in J){if(!(J.startRule in L))throw Error("Can't start parsing from rule \""+J.startRule+'".');M=L[J.startRule]}if(I=M(),I!==K&&fc===a.length)return I;throw I!==K&&fc<a.length&&e({type:"end",description:"end of input"}),f(null,kc,jc)}return a(b,Error),{SyntaxError:b,parse:c}}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.parser=c)}((this||0).self||global),function(a){"use strict";function b(){this.tree=[]}var c,d="process"in a;c=d?require("./parser.peg.js"):PixivNovelParser.parser,b.parse=function(a){try{return a=a.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(a){return"\n"===a||"ã€€"===a?a:" "}),c.parse(a)}catch(b){return console.error(b),[{type:"text",val:a}]}},b.prototype.parse=function(a){return this.tree=b.parse(a),this},b.prototype.toJSON=function(){return JSON.stringify(this.tree)},d?module.exports={Parser:b}:(a.PixivNovelParser=a.PixivNovalPerser||{},a.PixivNovelParser.Parser=b)}((this||0).self||global),function(a){"use strict";var b="process"in a;b?module.exports=require("./parser"):a.PixivNovelParser=a.PixivNovelParser||{}}((this||0).self||global);
//# sourceMappingURL=pixiv-novel-parser.min.js.map