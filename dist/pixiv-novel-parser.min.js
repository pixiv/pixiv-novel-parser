!function(a){var b="process"in a,c=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){W>U||(U>W&&(W=U,X=[]),X.push(a))}function g(){var a="novel@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=[],d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return Y[a]={nextPos:U,result:c},c}function h(){var b="text@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U;if(null!==a.substr(U).match(/^[^[]/)){var e=a.charAt(U);U++}else{var e=null;V&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(U).match(/^[^[]/)){var e=a.charAt(U);U++}else{var e=null;V&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=U,k=U,l=V;V=!1;var m=U,n=V;V=!1;var o=i();if(V=n,null===o)var p="";else{var p=null;U=m}if(V=l,null!==p){var q="";U=k}else var q=null;if(null!==q){if("["===a.substr(U,1)){var r="[";U+=1}else{var r=null;V&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;U=j}}else{var s=null;U=j}if(null!==s)var h=s;else var h=null}if(null!==h)for(var t=[];null!==h;){if(t.push(h),null!==a.substr(U).match(/^[^[]/)){var e=a.charAt(U);U++}else{var e=null;V&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(U).match(/^[^[]/)){var e=a.charAt(U);U++}else{var e=null;V&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=U,k=U,l=V;V=!1;var m=U,n=V;V=!1;var o=i();if(V=n,null===o)var p="";else{var p=null;U=m}if(V=l,null!==p){var q="";U=k}else var q=null;if(null!==q){if("["===a.substr(U,1)){var r="[";U+=1}else{var r=null;V&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;U=j}}else{var s=null;U=j}if(null!==s)var h=s;else var h=null}}else var t=null;var u=null!==t?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return N(b)}(t):null;if(null!==u)var v=u;else{var v=null;U=d}return Y[b]={nextPos:U,result:v},v}function i(){var a="tag@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=j();if(null!==c)var d=c;else{var e=k();if(null!==e)var d=e;else{var f=l();if(null!==f)var d=f;else{var g=m();if(null!==g)var d=g;else{var h=n();if(null!==h)var d=h;else var d=null}}}}return Y[a]={nextPos:U,result:d},d}function j(){var b="tagNewpage@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=U;if("[newpage]"===a.substr(U,9)){var g="[newpage]";U+=9}else{var g=null;V&&f('"[newpage]"')}if(null!==g){var h=x();if(null!==h)var i=h;else{var j=E();if(null!==j)var i=j;else var i=null}var k=null!==i?i:"";if(null!==k)var l=[g,k];else{var l=null;U=e}}else{var l=null;U=e}var m=null!==l?function(){return O()}():null;if(null!==m)var n=m;else{var n=null;U=d}return Y[b]={nextPos:U,result:n},n}function k(){var b="tagChapter@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=U;if("[chapter:"===a.substr(U,9)){var g="[chapter:";U+=9}else{var g=null;V&&f('"[chapter:"')}if(null!==g){var h=o();if(null!==h){if("]"===a.substr(U,1)){var i="]";U+=1}else{var i=null;V&&f('"]"')}if(null!==i){var j=x();if(null!==j)var k=j;else{var l=E();if(null!==l)var k=l;else var k=null}var m=null!==k?k:"";if(null!==m)var n=[g,h,i,m];else{var n=null;U=e}}else{var n=null;U=e}}else{var n=null;U=e}}else{var n=null;U=e}var p=null!==n?function(a){return P(a)}(n[1]):null;if(null!==p)var q=p;else{var q=null;U=d}return Y[b]={nextPos:U,result:q},q}function l(){var b="tagPixivimage@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=U;if("[pixivimage:"===a.substr(U,12)){var g="[pixivimage:";U+=12}else{var g=null;V&&f('"[pixivimage:"')}if(null!==g){var h=q();if(null!==h){var i=U;if("-"===a.substr(U,1)){var j="-";U+=1}else{var j=null;V&&f('"-"')}if(null!==j){var k=r();if(null!==k)var l=[j,k];else{var l=null;U=i}}else{var l=null;U=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(U,1)){var n="]";U+=1}else{var n=null;V&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;U=e}}else{var o=null;U=e}}else{var o=null;U=e}}else{var o=null;U=e}var p=null!==o?function(a,b){return Q(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var s=p;else{var s=null;U=d}return Y[b]={nextPos:U,result:s},s}function m(){var b="tagJump@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=U;if("[jump:"===a.substr(U,6)){var g="[jump:";U+=6}else{var g=null;V&&f('"[jump:"')}if(null!==g){var h=r();if(null!==h){if("]"===a.substr(U,1)){var i="]";U+=1}else{var i=null;V&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;U=e}}else{var j=null;U=e}}else{var j=null;U=e}var k=null!==j?function(a){return R(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;U=d}return Y[b]={nextPos:U,result:l},l}function n(){var b="tagJumpuri@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=U;if("[[jumpuri:"===a.substr(U,10)){var g="[[jumpuri:";U+=10}else{var g=null;V&&f('"[[jumpuri:"')}if(null!==g){var h=p();if(null!==h){if(">"===a.substr(U,1)){var i=">";U+=1}else{var i=null;V&&f('">"')}if(null!==i){for(var j=[],k=J();null!==k;){j.push(k);var k=J()}if(null!==j){var l=s();if(null!==l){for(var m=[],n=J();null!==n;){m.push(n);var n=J()}if(null!==m){if("]]"===a.substr(U,2)){var o="]]";U+=2}else{var o=null;V&&f('"]]"')}if(null!==o)var q=[g,h,i,j,l,m,o];else{var q=null;U=e}}else{var q=null;U=e}}else{var q=null;U=e}}else{var q=null;U=e}}else{var q=null;U=e}}else{var q=null;U=e}}else{var q=null;U=e}var r=null!==q?function(a,b){return S(a,b)}(q[1],q[4]):null;if(null!==r)var t=r;else{var t=null;U=d}return Y[b]={nextPos:U,result:t},t}function o(){var b="chapterTitle@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=[];if(null!==a.substr(U).match(/^[^\]]/)){var g=a.charAt(U);U++}else{var g=null;V&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(U).match(/^[^\]]/)){var g=a.charAt(U);U++}else{var g=null;V&&f("[^\\]]")}var h=null!==e?function(a){return M(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;U=d}return Y[b]={nextPos:U,result:i},i}function p(){var b="jumpuriTitle@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=[];if(null!==a.substr(U).match(/^[^>]/)){var g=a.charAt(U);U++}else{var g=null;V&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(U).match(/^[^>]/)){var g=a.charAt(U);U++}else{var g=null;V&&f("[^>]")}var h=null!==e?function(a){return M(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;U=d}return Y[b]={nextPos:U,result:i},i}function q(){var a="numeric@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=U,d=A();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=A()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;U=c}return Y[a]={nextPos:U,result:g},g}function r(){var a="integer@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=U,d=A();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=A()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;U=c}return Y[a]={nextPos:U,result:g},g}function s(){var b="URI@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=U,e=U,g=U;if("http"===a.substr(U,4)){var h="http";U+=4}else{var h=null;V&&f('"http"')}if(null!==h){if("s"===a.substr(U,1)){var i="s";U+=1}else{var i=null;V&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(U,3)){var k="://";U+=3}else{var k=null;V&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;U=g}}else{var l=null;U=g}}else{var l=null;U=g}if(null!==l){for(var m=[],n=t();null!==n;){m.push(n);var n=t()}if(null!==m)var o=[l,m];else{var o=null;U=e}}else{var o=null;U=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;U=d}return Y[b]={nextPos:U,result:q},q}function t(){var b="uri_chrs@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=u();if(null!==d)var e=d;else{var g=A();if(null!==g)var e=g;else{var h=U;if("%"===a.substr(U,1)){var i="%";U+=1}else{var i=null;V&&f('"%"')}if(null!==i){var j=C();if(null!==j)for(var k=[];null!==j;){k.push(j);var j=C()}else var k=null;if(null!==k)var l=[i,k];else{var l=null;U=h}}else{var l=null;U=h}if(null!==l)var e=l;else{if(null!==a.substr(U).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var m=a.charAt(U);U++}else{var m=null;V&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==m)var e=m;else var e=null}}}return Y[b]={nextPos:U,result:e},e}function u(){var b="ALPHA@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^[A-Z]/)){var d=a.charAt(U);U++}else{var d=null;V&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(U).match(/^[a-z]/)){var g=a.charAt(U);U++}else{var g=null;V&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return Y[b]={nextPos:U,result:e},e}function v(){var b="BIT@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if("0"===a.substr(U,1)){var d="0";U+=1}else{var d=null;V&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(U,1)){var g="1";U+=1}else{var g=null;V&&f('"1"')}if(null!==g)var e=g;else var e=null}return Y[b]={nextPos:U,result:e},e}function w(){var b="CHAR@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^[-]/)){var d=a.charAt(U);U++}else{var d=null;V&&f("[-]")}return Y[b]={nextPos:U,result:d},d}function x(){var b="CR@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if("\r"===a.substr(U,1)){var d="\r";U+=1}else{var d=null;V&&f('"\\r"')}return Y[b]={nextPos:U,result:d},d}function y(){var a="CRLF@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=U,d=x();if(null!==d){var e=E();if(null!==e)var f=[d,e];else{var f=null;U=c}}else{var f=null;U=c}return Y[a]={nextPos:U,result:f},f}function z(){var b="CTL@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^[\0-]/)){var d=a.charAt(U);U++}else{var d=null;V&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(U,1)){var g="";U+=1}else{var g=null;V&&f('""')}if(null!==g)var e=g;else var e=null}return Y[b]={nextPos:U,result:e},e}function A(){var b="DIGIT@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^[0-9]/)){var d=a.charAt(U);U++}else{var d=null;V&&f("[0-9]")}return Y[b]={nextPos:U,result:d},d}function B(){var b="DQUOTE@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^["]/)){var d=a.charAt(U);U++}else{var d=null;V&&f('["]')}return Y[b]={nextPos:U,result:d},d}function C(){var b="HEXDIG@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;var d=A();if(null!==d)var e=d;else{if("A"===a.substr(U,1)){var g="A";U+=1}else{var g=null;V&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(U,1)){var h="B";U+=1}else{var h=null;V&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(U,1)){var i="C";U+=1}else{var i=null;V&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(U,1)){var j="D";U+=1}else{var j=null;V&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(U,1)){var k="E";U+=1}else{var k=null;V&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(U,1)){var l="F";U+=1}else{var l=null;V&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return Y[b]={nextPos:U,result:e},e}function D(){var b="HTAB@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if("	"===a.substr(U,1)){var d="	";U+=1}else{var d=null;V&&f('"	"')}return Y[b]={nextPos:U,result:d},d}function E(){var b="LF@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if("\n"===a.substr(U,1)){var d="\n";U+=1}else{var d=null;V&&f('"\\n"')}return Y[b]={nextPos:U,result:d},d}function F(){var a="LWSP@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=[],d=J();if(null!==d)var e=d;else{var f=U,g=y();if(null!==g){var h=J();if(null!==h)var i=[g,h];else{var i=null;U=f}}else{var i=null;U=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=J();if(null!==d)var e=d;else{var f=U,g=y();if(null!==g){var h=J();if(null!==h)var i=[g,h];else{var i=null;U=f}}else{var i=null;U=f}if(null!==i)var e=i;else var e=null}}return Y[a]={nextPos:U,result:c},c}function G(){var b="OCTET@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^[\0-\xFF]/)){var d=a.charAt(U);U++}else{var d=null;V&&f("[\\0-\\xFF]")}return Y[b]={nextPos:U,result:d},d}function H(){var b="SP@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(" "===a.substr(U,1)){var d=" ";U+=1}else{var d=null;V&&f('" "')}return Y[b]={nextPos:U,result:d},d}function I(){var b="VCHAR@"+U,c=Y[b];if(c)return U=c.nextPos,c.result;if(null!==a.substr(U).match(/^[!-~]/)){var d=a.charAt(U);U++}else{var d=null;V&&f("[!-~]")}return Y[b]={nextPos:U,result:d},d}function J(){var a="WSP@"+U,b=Y[a];if(b)return U=b.nextPos,b.result;var c=H();if(null!==c)var d=c;else{var e=D();if(null!==e)var d=e;else var d=null}return Y[a]={nextPos:U,result:d},d}function K(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(X),d=Math.max(U,W),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function L(){for(var b=1,c=1,d=!1,e=0;W>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function M(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function N(a){return{type:"text",val:a}}function O(){return{type:"tag",name:"newpage"}}function P(a){return{type:"tag",name:"chapter",title:a}}function Q(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function R(a){return{type:"tag",name:"jump",pageNumber:a}}function S(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}var T={ALPHA:u,BIT:v,CHAR:w,CR:x,CRLF:y,CTL:z,DIGIT:A,DQUOTE:B,HEXDIG:C,HTAB:D,LF:E,LWSP:F,OCTET:G,SP:H,URI:s,VCHAR:I,WSP:J,chapterTitle:o,integer:r,jumpuriTitle:p,novel:g,numeric:q,tag:i,tagChapter:k,tagJump:m,tagJumpuri:n,tagNewpage:j,tagPixivimage:l,text:h,uri_chrs:t};if(void 0!==b){if(void 0===T[b])throw Error("Invalid rule name: "+e(b)+".")}else b="novel";var U=0,V=!0,W=0,X=[],Y={},Z=T[b]();if(null===Z||U!==a.length){var $=L();throw new this.SyntaxError(K(),$.line,$.column)}return Z},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.basicParser=c)}((this||0).self||global),function(a){var b="process"in a,c=function(){var a={parse:function(a,b){function c(a,b,c){for(var d=a,e=c-a.length,f=0;e>f;f++)d=b+d;return d}function d(a){var b=a.charCodeAt(0);if(255>=b)var d="x",e=2;else var d="u",e=4;return"\\"+d+c(b.toString(16).toUpperCase(),"0",e)}function e(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,d)+'"'}function f(a){ba>_||(_>ba&&(ba=_,ca=[]),ca.push(a))}function g(){var a="novel@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=[],d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}for(;null!==e;){c.push(e);var d=i();if(null!==d)var e=d;else{var f=h();if(null!==f)var e=f;else var e=null}}return da[a]={nextPos:_,result:c},c}function h(){var b="text@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_;if(null!==a.substr(_).match(/^[^[]/)){var e=a.charAt(_);_++}else{var e=null;aa&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(_).match(/^[^[]/)){var e=a.charAt(_);_++}else{var e=null;aa&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=_,k=_,l=aa;aa=!1;var m=_,n=aa;aa=!1;var o=i();if(aa=n,null===o)var p="";else{var p=null;_=m}if(aa=l,null!==p){var q="";_=k}else var q=null;if(null!==q){if("["===a.substr(_,1)){var r="[";_+=1}else{var r=null;aa&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;_=j}}else{var s=null;_=j}if(null!==s)var h=s;else var h=null}if(null!==h)for(var t=[];null!==h;){if(t.push(h),null!==a.substr(_).match(/^[^[]/)){var e=a.charAt(_);_++}else{var e=null;aa&&f("[^[]")}if(null!==e)for(var g=[];null!==e;)if(g.push(e),null!==a.substr(_).match(/^[^[]/)){var e=a.charAt(_);_++}else{var e=null;aa&&f("[^[]")}else var g=null;if(null!==g)var h=g;else{var j=_,k=_,l=aa;aa=!1;var m=_,n=aa;aa=!1;var o=i();if(aa=n,null===o)var p="";else{var p=null;_=m}if(aa=l,null!==p){var q="";_=k}else var q=null;if(null!==q){if("["===a.substr(_,1)){var r="[";_+=1}else{var r=null;aa&&f('"["')}if(null!==r)var s=[q,r];else{var s=null;_=j}}else{var s=null;_=j}if(null!==s)var h=s;else var h=null}}else var t=null;var u=null!==t?function(a){for(var b="",c=0;c<a.length;c++)b+=a[c].join("");return R(b)}(t):null;if(null!==u)var v=u;else{var v=null;_=d}return da[b]={nextPos:_,result:v},v}function i(){var a="tag@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=j();if(null!==c)var d=c;else{var e=k();if(null!==e)var d=e;else{var f=l();if(null!==f)var d=f;else{var g=m();if(null!==g)var d=g;else{var h=n();if(null!==h)var d=h;else{var i=u();if(null!==i)var d=i;else{var o=v();if(null!==o)var d=o;else{var p=w();if(null!==p)var d=p;else var d=null}}}}}}}return da[a]={nextPos:_,result:d},d}function j(){var b="tagNewpage@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[newpage]"===a.substr(_,9)){var g="[newpage]";_+=9}else{var g=null;aa&&f('"[newpage]"')}if(null!==g){var h=B();if(null!==h)var i=h;else{var j=I();if(null!==j)var i=j;else var i=null}var k=null!==i?i:"";if(null!==k)var l=[g,k];else{var l=null;_=e}}else{var l=null;_=e}var m=null!==l?function(){return S()}():null;if(null!==m)var n=m;else{var n=null;_=d}return da[b]={nextPos:_,result:n},n}function k(){var b="tagChapter@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[chapter:"===a.substr(_,9)){var g="[chapter:";_+=9}else{var g=null;aa&&f('"[chapter:"')}if(null!==g){var h=o();if(null!==h){if("]"===a.substr(_,1)){var i="]";_+=1}else{var i=null;aa&&f('"]"')}if(null!==i){var j=B();if(null!==j)var k=j;else{var l=I();if(null!==l)var k=l;else var k=null}var m=null!==k?k:"";if(null!==m)var n=[g,h,i,m];else{var n=null;_=e}}else{var n=null;_=e}}else{var n=null;_=e}}else{var n=null;_=e}var p=null!==n?function(a){return T(a)}(n[1]):null;if(null!==p)var q=p;else{var q=null;_=d}return da[b]={nextPos:_,result:q},q}function l(){var b="tagPixivimage@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[pixivimage:"===a.substr(_,12)){var g="[pixivimage:";_+=12}else{var g=null;aa&&f('"[pixivimage:"')}if(null!==g){var h=q();if(null!==h){var i=_;if("-"===a.substr(_,1)){var j="-";_+=1}else{var j=null;aa&&f('"-"')}if(null!==j){var k=r();if(null!==k)var l=[j,k];else{var l=null;_=i}}else{var l=null;_=i}var m=null!==l?l:"";if(null!==m){if("]"===a.substr(_,1)){var n="]";_+=1}else{var n=null;aa&&f('"]"')}if(null!==n)var o=[g,h,m,n];else{var o=null;_=e}}else{var o=null;_=e}}else{var o=null;_=e}}else{var o=null;_=e}var p=null!==o?function(a,b){return U(a,b&&b[1])}(o[1],o[2]):null;if(null!==p)var s=p;else{var s=null;_=d}return da[b]={nextPos:_,result:s},s}function m(){var b="tagJump@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[jump:"===a.substr(_,6)){var g="[jump:";_+=6}else{var g=null;aa&&f('"[jump:"')}if(null!==g){var h=r();if(null!==h){if("]"===a.substr(_,1)){var i="]";_+=1}else{var i=null;aa&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;_=e}}else{var j=null;_=e}}else{var j=null;_=e}var k=null!==j?function(a){return V(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;_=d}return da[b]={nextPos:_,result:l},l}function n(){var b="tagJumpuri@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[[jumpuri:"===a.substr(_,10)){var g="[[jumpuri:";_+=10}else{var g=null;aa&&f('"[[jumpuri:"')}if(null!==g){var h=p();if(null!==h){if(">"===a.substr(_,1)){var i=">";_+=1}else{var i=null;aa&&f('">"')}if(null!==i){for(var j=[],k=N();null!==k;){j.push(k);var k=N()}if(null!==j){var l=s();if(null!==l){for(var m=[],n=N();null!==n;){m.push(n);var n=N()}if(null!==m){if("]]"===a.substr(_,2)){var o="]]";_+=2}else{var o=null;aa&&f('"]]"')}if(null!==o)var q=[g,h,i,j,l,m,o];else{var q=null;_=e}}else{var q=null;_=e}}else{var q=null;_=e}}else{var q=null;_=e}}else{var q=null;_=e}}else{var q=null;_=e}}else{var q=null;_=e}var r=null!==q?function(a,b){return W(a,b)}(q[1],q[4]):null;if(null!==r)var t=r;else{var t=null;_=d}return da[b]={nextPos:_,result:t},t}function o(){var b="chapterTitle@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=[];if(null!==a.substr(_).match(/^[^\]]/)){var g=a.charAt(_);_++}else{var g=null;aa&&f("[^\\]]")}for(;null!==g;)if(e.push(g),null!==a.substr(_).match(/^[^\]]/)){var g=a.charAt(_);_++}else{var g=null;aa&&f("[^\\]]")}var h=null!==e?function(a){return Q(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;_=d}return da[b]={nextPos:_,result:i},i}function p(){var b="jumpuriTitle@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=[];if(null!==a.substr(_).match(/^[^>]/)){var g=a.charAt(_);_++}else{var g=null;aa&&f("[^>]")}for(;null!==g;)if(e.push(g),null!==a.substr(_).match(/^[^>]/)){var g=a.charAt(_);_++}else{var g=null;aa&&f("[^>]")}var h=null!==e?function(a){return Q(a.join(""))}(e):null;if(null!==h)var i=h;else{var i=null;_=d}return da[b]={nextPos:_,result:i},i}function q(){var a="numeric@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=_,d=E();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=E()}else var e=null;var f=null!==e?function(a){return a.join("")}(e):null;if(null!==f)var g=f;else{var g=null;_=c}return da[a]={nextPos:_,result:g},g}function r(){var a="integer@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=_,d=E();if(null!==d)for(var e=[];null!==d;){e.push(d);var d=E()}else var e=null;var f=null!==e?function(a){return parseInt(a.join(""),10)}(e):null;if(null!==f)var g=f;else{var g=null;_=c}return da[a]={nextPos:_,result:g},g}function s(){var b="URI@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_,g=_;if("http"===a.substr(_,4)){var h="http";_+=4}else{var h=null;aa&&f('"http"')}if(null!==h){if("s"===a.substr(_,1)){var i="s";_+=1}else{var i=null;aa&&f('"s"')}var j=null!==i?i:"";if(null!==j){if("://"===a.substr(_,3)){var k="://";_+=3}else{var k=null;aa&&f('"://"')}if(null!==k)var l=[h,j,k];else{var l=null;_=g}}else{var l=null;_=g}}else{var l=null;_=g}if(null!==l){for(var m=[],n=t();null!==n;){m.push(n);var n=t()}if(null!==m)var o=[l,m];else{var o=null;_=e}}else{var o=null;_=e}var p=null!==o?function(a,b){return a.join("")+b.join("")}(o[0],o[1]):null;if(null!==p)var q=p;else{var q=null;_=d}return da[b]={nextPos:_,result:q},q}function t(){var b="uri_chrs@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=y();if(null!==d)var e=d;else{var g=E();if(null!==g)var e=g;else{var h=_;if("%"===a.substr(_,1)){var i="%";_+=1}else{var i=null;aa&&f('"%"')}if(null!==i){var j=G();if(null!==j)for(var k=[];null!==j;){k.push(j);var j=G()}else var k=null;if(null!==k)var l=[i,k];else{var l=null;_=h}}else{var l=null;_=h}if(null!==l)var e=l;else{if(null!==a.substr(_).match(/^[\-._~!$&'()*+,;=:\/@.?#]/)){var m=a.charAt(_);_++}else{var m=null;aa&&f("[\\-._~!$&'()*+,;=:\\/@.?#]")}if(null!==m)var e=m;else var e=null}}}return da[b]={nextPos:_,result:e},e}function u(){var b="tagRuby@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[ruby:"===a.substr(_,6)){var g="[ruby:";_+=6}else{var g=null;aa&&f('"[ruby:"')}if(null!==g){var h=[];if(null!==a.substr(_).match(/^[^>]/)){var i=a.charAt(_);_++}else{var i=null;aa&&f("[^>]")}for(;null!==i;)if(h.push(i),null!==a.substr(_).match(/^[^>]/)){var i=a.charAt(_);_++}else{var i=null;aa&&f("[^>]")}if(null!==h){if(">"===a.substr(_,1)){var j=">";_+=1}else{var j=null;aa&&f('">"')}if(null!==j){var k=[];if(null!==a.substr(_).match(/^[^\]]/)){var l=a.charAt(_);_++}else{var l=null;aa&&f("[^\\]]")}for(;null!==l;)if(k.push(l),null!==a.substr(_).match(/^[^\]]/)){var l=a.charAt(_);_++}else{var l=null;aa&&f("[^\\]]")}if(null!==k){if("]"===a.substr(_,1)){var m="]";_+=1}else{var m=null;aa&&f('"]"')}if(null!==m)var n=[g,h,j,k,m];else{var n=null;_=e}}else{var n=null;_=e}}else{var n=null;_=e}}else{var n=null;_=e}}else{var n=null;_=e}var o=null!==n?function(a,b){return X(Q(a.join("")),Q(b.join("")))}(n[1],n[3]):null;if(null!==o)var p=o;else{var p=null;_=d}return da[b]={nextPos:_,result:p},p}function v(){var b="tagEmoji@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[emoji:"===a.substr(_,7)){var g="[emoji:";_+=7}else{var g=null;aa&&f('"[emoji:"')}if(null!==g){var h=x();if(null!==h){if("]"===a.substr(_,1)){var i="]";_+=1}else{var i=null;aa&&f('"]"')}if(null!==i)var j=[g,h,i];else{var j=null;_=e}}else{var j=null;_=e}}else{var j=null;_=e}var k=null!==j?function(a){return Y(a)}(j[1]):null;if(null!==k)var l=k;else{var l=null;_=d}return da[b]={nextPos:_,result:l},l}function w(){var b="tagStrong@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=_;if("[strong:"===a.substr(_,8)){var g="[strong:";_+=8}else{var g=null;aa&&f('"[strong:"')}if(null!==g){var h=[];if(null!==a.substr(_).match(/^[^\]]/)){var i=a.charAt(_);_++}else{var i=null;aa&&f("[^\\]]")}for(;null!==i;)if(h.push(i),null!==a.substr(_).match(/^[^\]]/)){var i=a.charAt(_);_++}else{var i=null;aa&&f("[^\\]]")}if(null!==h){if("]"===a.substr(_,1)){var j="]";_+=1}else{var j=null;aa&&f('"]"')}if(null!==j)var k=[g,h,j];else{var k=null;_=e}}else{var k=null;_=e}}else{var k=null;_=e}var l=null!==k?function(a){return Z(Q(a.join("")))}(k[1]):null;if(null!==l)var m=l;else{var m=null;_=d}return da[b]={nextPos:_,result:m},m}function x(){var b="emojiName@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=_,e=y();if(null!==e)var g=e;else{var h=E();if(null!==h)var g=h;else{if("-"===a.substr(_,1)){var i="-";_+=1}else{var i=null;aa&&f('"-"')}if(null!==i)var g=i;else var g=null}}if(null!==g)for(var j=[];null!==g;){j.push(g);var e=y();if(null!==e)var g=e;else{var h=E();if(null!==h)var g=h;else{if("-"===a.substr(_,1)){var i="-";_+=1}else{var i=null;aa&&f('"-"')}if(null!==i)var g=i;else var g=null}}}else var j=null;var k=null!==j?function(a){return Q(a.join(""))}(j):null;if(null!==k)var l=k;else{var l=null;_=d}return da[b]={nextPos:_,result:l},l}function y(){var b="ALPHA@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^[A-Z]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f("[A-Z]")}if(null!==d)var e=d;else{if(null!==a.substr(_).match(/^[a-z]/)){var g=a.charAt(_);_++}else{var g=null;aa&&f("[a-z]")}if(null!==g)var e=g;else var e=null}return da[b]={nextPos:_,result:e},e}function z(){var b="BIT@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if("0"===a.substr(_,1)){var d="0";_+=1}else{var d=null;aa&&f('"0"')}if(null!==d)var e=d;else{if("1"===a.substr(_,1)){var g="1";_+=1}else{var g=null;aa&&f('"1"')}if(null!==g)var e=g;else var e=null}return da[b]={nextPos:_,result:e},e}function A(){var b="CHAR@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^[-]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f("[-]")}return da[b]={nextPos:_,result:d},d}function B(){var b="CR@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if("\r"===a.substr(_,1)){var d="\r";_+=1}else{var d=null;aa&&f('"\\r"')}return da[b]={nextPos:_,result:d},d}function C(){var a="CRLF@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=_,d=B();if(null!==d){var e=I();if(null!==e)var f=[d,e];else{var f=null;_=c}}else{var f=null;_=c}return da[a]={nextPos:_,result:f},f}function D(){var b="CTL@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^[\0-]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f("[\\0-]")}if(null!==d)var e=d;else{if(""===a.substr(_,1)){var g="";_+=1}else{var g=null;aa&&f('""')}if(null!==g)var e=g;else var e=null}return da[b]={nextPos:_,result:e},e}function E(){var b="DIGIT@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^[0-9]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f("[0-9]")}return da[b]={nextPos:_,result:d},d}function F(){var b="DQUOTE@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^["]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f('["]')}return da[b]={nextPos:_,result:d},d}function G(){var b="HEXDIG@"+_,c=da[b];if(c)return _=c.nextPos,c.result;var d=E();if(null!==d)var e=d;else{if("A"===a.substr(_,1)){var g="A";_+=1}else{var g=null;aa&&f('"A"')}if(null!==g)var e=g;else{if("B"===a.substr(_,1)){var h="B";_+=1}else{var h=null;aa&&f('"B"')}if(null!==h)var e=h;else{if("C"===a.substr(_,1)){var i="C";_+=1}else{var i=null;aa&&f('"C"')}if(null!==i)var e=i;else{if("D"===a.substr(_,1)){var j="D";_+=1}else{var j=null;aa&&f('"D"')}if(null!==j)var e=j;else{if("E"===a.substr(_,1)){var k="E";_+=1}else{var k=null;aa&&f('"E"')}if(null!==k)var e=k;else{if("F"===a.substr(_,1)){var l="F";_+=1}else{var l=null;aa&&f('"F"')}if(null!==l)var e=l;else var e=null}}}}}}return da[b]={nextPos:_,result:e},e}function H(){var b="HTAB@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if("	"===a.substr(_,1)){var d="	";_+=1}else{var d=null;aa&&f('"	"')}return da[b]={nextPos:_,result:d},d}function I(){var b="LF@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if("\n"===a.substr(_,1)){var d="\n";_+=1}else{var d=null;aa&&f('"\\n"')}return da[b]={nextPos:_,result:d},d}function J(){var a="LWSP@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=[],d=N();if(null!==d)var e=d;else{var f=_,g=C();if(null!==g){var h=N();if(null!==h)var i=[g,h];else{var i=null;_=f}}else{var i=null;_=f}if(null!==i)var e=i;else var e=null}for(;null!==e;){c.push(e);var d=N();if(null!==d)var e=d;else{var f=_,g=C();if(null!==g){var h=N();if(null!==h)var i=[g,h];else{var i=null;_=f}}else{var i=null;_=f}if(null!==i)var e=i;else var e=null}}return da[a]={nextPos:_,result:c},c}function K(){var b="OCTET@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^[\0-\xFF]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f("[\\0-\\xFF]")}return da[b]={nextPos:_,result:d},d}function L(){var b="SP@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(" "===a.substr(_,1)){var d=" ";_+=1}else{var d=null;aa&&f('" "')}return da[b]={nextPos:_,result:d},d}function M(){var b="VCHAR@"+_,c=da[b];if(c)return _=c.nextPos,c.result;if(null!==a.substr(_).match(/^[!-~]/)){var d=a.charAt(_);_++}else{var d=null;aa&&f("[!-~]")}return da[b]={nextPos:_,result:d},d}function N(){var a="WSP@"+_,b=da[a];if(b)return _=b.nextPos,b.result;var c=L();if(null!==c)var d=c;else{var e=H();if(null!==e)var d=e;else var d=null}return da[a]={nextPos:_,result:d},d}function O(){function b(a){a.sort();for(var b=null,c=[],d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(ca),d=Math.max(_,ba),f=d<a.length?e(a.charAt(d)):"end of input";return"Expected "+c+" but "+f+" found."}function P(){for(var b=1,c=1,d=!1,e=0;ba>e;e++){var f=a.charAt(e);"\n"===f?(d||b++,c=1,d=!1):"\r"===f|"\u2028"===f||"\u2029"===f?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}function Q(a){return a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}function R(a){return{type:"text",val:a}}function S(){return{type:"tag",name:"newpage"}}function T(a){return{type:"tag",name:"chapter",title:a}}function U(a,b){return{type:"tag",name:"pixivimage",illustID:a,pageNumber:b||null}}function V(a){return{type:"tag",name:"jump",pageNumber:a}}function W(a,b){return{type:"tag",name:"jumpuri",title:a,uri:b}}function X(a,b){return{type:"tag",name:"ruby",rubyBase:a,rubyText:b}}function Y(a){return{type:"tag",name:"emoji",emojiName:a}}function Z(a){return{type:"tag",name:"strong",val:a}}var $={ALPHA:y,BIT:z,CHAR:A,CR:B,CRLF:C,CTL:D,DIGIT:E,DQUOTE:F,HEXDIG:G,HTAB:H,LF:I,LWSP:J,OCTET:K,SP:L,URI:s,VCHAR:M,WSP:N,chapterTitle:o,emojiName:x,integer:r,jumpuriTitle:p,novel:g,numeric:q,tag:i,tagChapter:k,tagEmoji:v,tagJump:m,tagJumpuri:n,tagNewpage:j,tagPixivimage:l,tagRuby:u,tagStrong:w,text:h,uri_chrs:t};if(void 0!==b){if(void 0===$[b])throw Error("Invalid rule name: "+e(b)+".")}else b="novel";var _=0,aa=!0,ba=0,ca=[],da={},ea=$[b]();if(null===ea||_!==a.length){var fa=P();throw new this.SyntaxError(O(),fa.line,fa.column)}return ea},toSource:function(){return this._source}
};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}();b?module.exports=c:(a.PixivNovelParser=a.PixivNovelParser||{},a.PixivNovelParser.extendedParser=c)}((this||0).self||global),function(a){"use strict";function b(a){a=a||{},this.syntax=a.syntax||"basic",this.tree=[]}var c,d,e="process"in a;e?(c=require("./parser.peg.js"),d=require("./parser-extended.peg.js")):(c=PixivNovelParser.basicParser,d=PixivNovelParser.extendedParser),b.parse=function(a,b){b=b||{},b.syntax=b.syntax||"basic";try{switch(a=a.replace(/\r?\n/g,"\n").replace(/[\s\u200c]/g,function(a){return"\n"===a||"ã€€"===a?a:" "}),b.syntax){case"extended":return d.parse(a);case"basic":default:return c.parse(a)}}catch(e){return console.error(e),[{type:"text",val:a}]}},b.prototype.parse=function(a){return this.tree=b.parse(a,{syntax:this.syntax}),this},b.prototype.toJSON=function(){return JSON.stringify(this.tree)},e?module.exports={Parser:b}:(a.PixivNovelParser=a.PixivNovalPerser||{},a.PixivNovelParser.Parser=b)}((this||0).self||global),function(a){"use strict";var b="process"in a;b?module.exports=require("./parser"):a.PixivNovelParser=a.PixivNovelParser||{}}((this||0).self||global);
//# sourceMappingURL=pixiv-novel-parser.min.js.map